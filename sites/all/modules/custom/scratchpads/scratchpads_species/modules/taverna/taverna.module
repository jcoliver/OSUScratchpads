<?php

/**
 * Implements hook_block_info().
 */
function taverna_block_info(){
  return array(
    'default' => array(
      'info' => t('Taverna Ecological Niche Modelling Species Page Block'),
      'cache' => DRUPAL_CACHE_PER_PAGE,
      // FIXME - Does the following URL make sense for a Taverna player?
      'pages' => 'taxonomy/term/*/descriptions',
      'visibility' => BLOCK_VISIBILITY_LISTED,
      'status' => 1,
      'region' => 'content',
      'weight' => 100
    )
  );
}

/**
 * Implements hook_block_view().
 */
function taverna_block_view($delta = ''){
  switch($delta){
    default:
      // The following URL will be altered once the Taverna player is installed in a 
      // central location.
      // 157.140.126.159
      return array(
        'subject' => t('Run an Ecological Niche Model via BioVeL'),
        'content' => array(
          'iframe' => array(
            '#markup' => '<iframe src="http://player.at.biovel.eu/workflows/5/runs/new?embedded=true&url='.url('taxonomy/term/'.arg(2).'/enm.csv', array('absolute' => TRUE)).'" width="100%" height="600px"/>' 
          )
        )
      );
  }
  return array();
}
